# Instrumentation Code

## Getting started

To use this in your own web application include instrument.js within your html page as `<script src="instrument.js"></script>` then include popup.css within your html page as `<link rel="stylesheet" href="popup.css">`. Within instrument.js you can change the global values of `prov` to match your provenance generation endpoint and `provHeaderName` to match the name of the header you want to use for provenance data.

## Functionality

The functionality of this implementation allows for the easy Instrumentation of Ajax within a web application by proxying the `XMLHttpRequest.open` function. This is called functional hooking and allowed you to insert your own custom code into a function at runtime. Each time an Ajax request is made it collects and stores relevant metadata in a document variable which can be accessed by calling the DOM id of the element that has been instrumented. This metadata includes the method type, url of the request, the DOM id manipulated. When the headers from the request is received it will then search through the headers for the header name specified in the global variable `provHeaderName`. If this header is found it will then make a fetch call to the endpoint specified in the value of that header to retrieve the provenance data generated by the request storing it as a document variable. This is then displayed back to the end user with the previous metadata as a popup within the web application, where the data has been formatted using popup.css to be presentable to the end user.

## Future Work

Future work may include extending functionality to include the instrumentation of fetch calls and other http methods used to get data from a server.
